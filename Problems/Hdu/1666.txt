<html>
<head>
<meta name="keywords" content="HDOJ ACM ICPC OJ C C++ Pascal Java">
<meta http-equiv="Content-Type" content="text/html;charset=gb2312">
<link rel="stylesheet" type="text/css" href="/images/global.css" media="all">
<link rel="stylesheet" type="text/css" href="/css/diyinhead.css" media="all">
<link rel="stylesheet" type="text/css" href="/css/webinhead.css" media="all">
<script src="/js/global.js" type="text/javascript"></script><script src="/js/register.js" type="text/javascript"></script><script src="/js/MathJax/MathJax/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script><title>Problem - 1666</title>
</head>
<body>
<a name="top"></a>
<table align="center" cellspacing="0" cellpadding="0" width="980" border="0" style="word-wrap:break-word">
<tr>
	<td style="border:#1A5CC8 1px solid" align="center" width="100%">
		<a href="/">
			<img src="/images/banner.jpg" width="100%" height="116" border="0">
		</a>
	</td>
</tr>
<tr>
	<td style="border:#1A5CC8 1px solid">
	<table cellspacing="0" cellpadding="1" width="979px">
	<tr bgcolor="#1A5CC8" align="center" class="banner" height="25">
		<td>Online Judge</td>
		<td>Online Exercise</td>
		<td>Online Teaching</td>
		<td>Online Contests</td>
	<td>Exercise Author</td>
	</tr>
	<tr style="font-size:16px" align="center">
		<td width="20%" valign="top">
		<a href="/faq.php" style="text-decoration: none">F.A.Q</a><br>
		<a href="/friends" style="text-decoration: none">Hand In Hand</a><br>
		<a href="/onlineuser.php" style="text-decoration: none">Online Acmers</a>	<br>
		<!-- /onlineuser.php-->
		
		<a href="/forum" style="text-decoration: none">Forum | </a><a href="/discuss/public/list.php" style="text-decoration: none">Discuss</a><br>
		<a href="/statistic/submit_graph.php" style="text-decoration: none">Statistical Charts</a><br>
		</td>
		<td width="20%" valign="top">
		<form action="/search.php" method="get">
		<a href="/listproblem.php?vol=1" style="text-decoration: none">Problem Archive</a><br>
		<!--<a href="http://feeds.feedburner.com/Hdoj-problemset"><img src="/images/rss1.jpg" alt="problemset" style="vertical-align:text-bottom;"width=20 height=20></a><br>-->
		<!--
			 <a href="/submit.php">Submit Solution</a><br>
		-->	
		<a href="/status.php" style="text-decoration: none">Realtime Judge Status</a><br>

		<a href="/ranklist.php" style="text-decoration: none">Authors Ranklist</a><br>
		<input name="field" value="author" type="hidden"><input class="text60" name="key">&#160;<input class="button40" type="submit" value="Search">
		
		<!--
			<input name=field value=problem type=hidden><input class=text60 name=key>&nbsp;<input class=button40 type=submit value=Search>
		-->
		</form>
		</td>
		<td width="20%" valign="top">
		 <form action="/search.php" method="get"> 
		&#160;&#160;&#160;&#160;&#160;<a style="text-decoration: none" href="http://code.hdu.edu.cn/">C/C++/Java Exams &#160;&#160;&#160;&#160;</a><br>
		<a style="text-decoration: none" href="/game">ACM Steps</a><br>
		<a href="/ITJobs/">Go to Job</a><br>	
		<a href="/livecast" style="text-decoration: none">Contest LiveCast</a><br>
		<a style="text-decoration: none" href="/region">ICPC@China</a><br>
		<!-- <a href="/register.php">Register New Author</a><br> -->
		<!-- <a href="/modifyuser.php">Update Your Information</a><br> -->
		</form>
		</td>
		<td width="20%" valign="top">
		<a href="http://bestcoder.hdu.edu.cn" style="text-decoration: none; color: red; font-weight: bold;">Best Coder <sup style="color: gray;">beta</sup></a><br><a href="/vip/contest_list.php" style="text-decoration: none">VIP</a> | <a href="/contests/contest_list.php" style="text-decoration: none">STD Contests</a><br><a href="http://code.hdu.edu.cn/vcontest" style="text-decoration: none">Virtual Contests </a><br>&#160;&#160;<a href="/diy/contest_list.php" style="text-decoration: none">&#160;&#160;DIY | </a><a href="/webcontest" style="text-decoration: none"><font color="">Web-DIY</font> <font size="1" color="gray"><sup>beta</sup></font></a><br><a style="text-decoration: none" href="/recentcontest">Recent Contests</a><br>		</td>
		<td width="20%">
					<form method="post" action="/userloginex.php?action=login">
			  <table width="168" border="0" align="center" cellspacing="0">
			  	<tr><td align="center" colspan="2"><a href="/qqlogin/oauth/login.php"><img src="/qqlogin/images/qqlogin.png" border="0"></a></td></tr>
				<tr>
<td width="68">Author ID&#160;</td>
<td align="right"><input name="username" type="text" class="text90" maxlength="20"></td>
</tr>
				<tr>
<td>Password&#160;</td>
<td align="right"><input name="userpass" type="password" class="text90" maxlength="20"></td>
</tr>
			  </table>
			  <input name="login" type="submit" class="button40" value="Sign In">&#160;<a href="/register.php" style="text-decoration: none">Register new ID</a>
			</form>
						</td>
	</tr>
	</table>
	</td>
</tr>
<tr>
	<td>
		<div align="center" id="rollword"><marquee scrollamount="2" width="600" scrolldelay="30" onmouseover="javascript:this.stop();" onmouseout="javascript:this.start();"><b style="margin-right:20px"><a style="color:red" href="http://acm.hdu.edu.cn/discuss/public/post/reply.php?postid=20680&amp;messageid=1&amp;deep=0">New~ 关于举办杭电程序设计竞赛（2014'12）的报名通知
</a>


<a style="color:blue" href="http://bestcoder.hdu.edu.cn/contests/contest_list.php">【比赛提醒】BestCoder 你报名了吗？（点击报名）</a>

<a href="http://bestcoder.hdu.edu.cn/handbook/handbook-v2.0.htm" style="color:blue">【科普】什么是BestCoder？如何参加？</a><br>
</b></marquee></div>	</td>
</tr>
<tr><td align="center">
<h1 style="color:#1A5CC8">The Floor Bricks</h1>
<font><b><span style="font-family:Arial;font-size:12px;font-weight:bold;color:green">Time Limit: 9000/3000 MS (Java/Others)&#160;&#160;&#160;&#160;Memory Limit: 32768/32768 K (Java/Others)<br>Total Submission(s): 24&#160;&#160;&#160;&#160;Accepted Submission(s): 8<br></span></b></font><br><br><div class="panel_title" align="left">Problem Description</div> <div class="panel_content">Robert decided to decorate his new room with a cool pattern on the floor, composed with colorful floor bricks. After several days' work, he finally felt satisfied with the pattern he created with the odd shaped bricks. Soon, he found a problem. As the border of the pattern is not a perfect rectangle, the floor is not filled with bricks completely. However, since the shapes of the bricks are quite odd, it is not an easy work to fill the floor with these bricks completely. (Although a brick with a unit size is provided, this kind of brick is quite expensive usually. Fig.1 shows an example of a set of bricks) As Robert was very proud of his brick pattern, he refuses to modify even one brick in his pattern in order to satisfy the need of filling the floor completely. Instead, he asked you to find solutions for him to fill the rest part of the floor completely with the given bricks so that the Gils needed to buy these bricks are minimized. Of course, the bricks can not overlap each other to fill the floor. Please note that the bricks can be rotated, but cannot be flipped over. In addition, you may assume that all kinds of bricks can be contained within a 3×3 square box. <br><br><center><img src="/data/images/1666-1.jpg"></center>
<br>As the pattern of bricks covers most areas of the floor, the uncovered part of the floor is actually located at the bottom border of the rectangular shaped floor. Therefore, an uncovered part like the one in Fig.2 can be described with a series of integers, which represents the number of square blocks missed in each column, starting from the left. Thus, the shape in Fig.2 can be described with 11 integers: 2 2 1 2 3 5 2 3 3 4 1. In addition, you may assume that these integers are no larger than 5. Fig.3 shows a solution to fill the floor with the brick set in Fig.1 that costs minimal Gils. <br><center><img src="/data/images/1666-2.jpg"></center>
<br><center><img src="/data/images/1666-3.jpg"></center>
<br>
</div>
<div class="panel_bottom">&#160;</div>
<br><div class="panel_title" align="left">Input</div> <div class="panel_content">The input consists of at most 20 test cases. The first line of each test case contains an integer n ( 1&lt;=n&lt;=1000), which is the width of the floor. The second line contains n integers, separated by single spaces. These integers describe the shape of the uncovered floor as mentioned above. The third line contains an integer m ( 1&lt;=m&lt;=100), which is the number of bricks available. After this is the detailed description of the m bricks. <br><br>Each brick description consists of 4 lines. The first line is a positive integer, which is the price of that brick in Gils. After this line, there are three lines, each consisting of three characters, which describe the shape of the brick. A dot character represents a space in the shape and a sharp character # represents a square block in the shape. You can be sure that the blocks are always connected to form the brick. <br><br>There is a line containing a zero after the last test case, which signifies the end of the input and should not be processed. <br>
</div>
<div class="panel_bottom">&#160;</div>
<br><div class="panel_title" align="left">Output</div> <div class="panel_content">For each test case, output a line `Need at least g Gil(s).', where g is the minimal Gils needed to fill the floor with the given bricks. If the floor cannot be filled with the given bricks, output `Impossible.' instead. Do not output blank lines between cases. <br><br>
</div>
<div class="panel_bottom">&#160;</div>
<br><div class="panel_title" align="left">Sample Input</div>
<div class="panel_content"><pre><div style="font-family:Courier New,Courier,monospace;">11
1 4 3 3 2 5 3 2 1 2 2
4
2
#..
#..
##.
3
.#.
.##
.#.
5
...
#..
##.
9
...
.#.
...
1
1
1
1
..#
...
...
1
1
1
1
.##
...
...
0</div></pre></div>
<div class="panel_bottom">&#160;</div>
<br><div class="panel_title" align="left">Sample Output</div>
<div class="panel_content"><pre><div style="font-family:Courier New,Courier,monospace;">Need at least 28 Gil(s).
Need at least 1 Gil(s).
Impossible.</div></pre></div>
<div class="panel_bottom">&#160;</div>
<br><div class="panel_title" align="left">Source</div> <div class="panel_content"> <a href="/search.php?field=problem&amp;key=2004+Asia+Regional+Shanghai+&amp;source=1&amp;searchmode=source"> 2004 Asia Regional Shanghai  </a> </div> <div class="panel_bottom">&#160;</div>
<br><div class="panel_title" align="left">Recommend</div> <div class="panel_content">xhd</div>
<div class="panel_bottom">&#160;</div>
<br><center style="font-size:15px;font-family:Arial;font-weight:bold;color:#1A5CC8">
<a href="statistic.php?pid=1666">Statistic</a>&#160;|&#160;<a href="submit.php?pid=1666">Submit</a>&#160;|&#160;<a href="./discuss/problem/list.php?problemid=1666">Discuss</a> | <a href="note/note.php?pid=1666">Note</a><br>
</center>
</td></tr>
<tr>
<td>
	<table style="border:#1A5CC8 1px solid; font-size:14px" cellspacing="0" cellpadding="1" width="100%">
	<tr align="center">
		<td class="footer_link" height="45">
<a href="/">Home</a> | <a href="#top">Top</a>
</td>
		<td style="padding:6px">
			Hangzhou Dianzi University Online Judge 3.0<br>
			Copyright &#169; 2005-2014 <a href="mailto:acm@hdu.edu.cn">HDU ACM Team</a>. All Rights Reserved.<br>
			<a href="../about_us/developer.php">Designer &amp; Developer </a>: <a>Wang Rongtao</a>&amp;nbsp<a>LinLe</a>&amp;nbsp<a href="mailto:gjavac@gmail.com">GaoJie</a>&amp;nbsp<a href="mailto:gl8997@gmail.com">GanLu</a><br>
			<span class="pagerunstatus">Total 0.000000(s) query 2, Server time : 2014-12-16 04:11:22, Gzip disabled</span>		</td>
		<td class="footer_link">
			<!-- <a href="javascript:history.go(-1);">Back</a> | <a href="javascript:history.forward();">Forward</a>-->
			<a href="/admin">Administration</a>	
		</td>
	</tr>
	</table>
</td>
</tr>
</table>
</body>
</html>